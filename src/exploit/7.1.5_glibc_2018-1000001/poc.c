#include <stdio.h>
#include <unistd.h>
#include <stdlib.h>
#include <string.h>

void main() {
    char *path;

    struct {
        char canary[16];
        char buffer[80];
    } buf;
    memset(buf.canary, 47, 1);  // put a '/' before the buffer
    memset(buf.buffer, 48, sizeof(buf.buffer));
    
    //path = getcwd(NULL, 0);
    //puts(path);
    
    chroot("/tmp");
    //path = getcwd(NULL, 0);
    //puts(path);

    realpath("../../../../BBBB", buf.buffer);
    if (!strcmp(buf.canary, "/BBBB")) {
        puts("Vulnerable");
    } else {
        puts("Not vulnerable");
    }
}
